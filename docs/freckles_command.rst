############
``freckles``
############

Description
***********

``freckles`` is an application that downloads a remote code or data repository (I call such a thing a 'freckle') that is structured according to one or some conventions. After download, ``freckles`` will execute pre-defined tasks appropriate for the type of `freckle` in question.

In order to handle those different data profiles, ``freckles`` can be extended with so called *adapters*. For example, if the `freckle` is a python project, ``freckles`` will use the ``python-dev`` adapter which will create a virtualenv named like the repository (after, if necessary, downloading everything that is needed to create virtualenvs in the first place), download and install all dependencies it can find in any potential ``requirement_*.txt`` files, and then execute either ``pip install -e .`` or  ``python setup.py develop`` inside the created virtualenv.

Or, the `freckle` is a folder containing subfolders which in turn contain `dotfiles` (that's what configuration files are called in Unix-land). ``freckles`` will download this repo, install potentially configured applications that relate to the configuration files, and symbolically link those configuration files to the appropriate places.


Usage
*****

.. admonition:: (Autogenerated) cli help

    .. click:: freckles.freckles_cli:cli
       :prog: freckles
       :link-command-prefix: adapters


Details
*******

Adapters & profiles
===================

Currently, only 2 types of data are supported by *freckles*: :doc:`dotfiles </adapters/dotfiles>` and :doc:`python dev projects </adapters/python-dev>`. To encourage the creation of lots of adapters, in order to support lots of different data-types, *freckles* tries to make it as easy as possible to create new adapters.


Writing adapters
----------------

As *freckles* uses *ansible* as the backend technology to do all the heavy lifting, `all ansible modules <http://docs.ansible.com/ansible/latest/list_of_all_modules.html>`_, and `all roles on ansible galaxy <https://galaxy.ansible.com>`_ are readily available to be re-used in *freckles adapters*.

A *freckle adapter* consists of 2 to 3 text files, located in the same folder. The first one, ``freckles-adapter.yml`` is a metadata file that contains a description of its purpose, (optinal) command-line argument definitions to enable users to provide input to change the default behaviour, and default variables, if necessary.

The other 2 files are similar to ansible playbook files in format, and only one of them is required, which one is up to the developer and use-case. It is possible to use all 2 though, of course:

``init-tasks.yml``
    this contains tasks that only have to be executed once, even if *freckles* processes multiple *freckle* folders of the same data type. An example would be a 'static webpage' datatype, where the webserver to host the page(s) only needs to be installed once, independent of how many websites are hosted.

``freckle-tasks.yml``
    this contains tasks that have to be executed once for every *freckle* folder that is processed. Using the example of a webserver, this file would contain for example tasks to create a virtual host for every 'website freckle'.

For examples, check out the source code of the default adapters *freckles* comes with:
