---
# include makkus.dotfiles role
# - debug: var=freckles_profile_folders

# sometimes this needs to be done on a new box, otherwise apt install fails
- name: "update apt cache"
  become: yes
  apt:
    update_cache: yes
    cache_valid_time: 3600
  when: "ansible_distribution == 'Debian' and (pkg_mgr is defined and (pkg_mgr == 'auto' or pkg_mgr == 'apt'))"
  ignore_errors: true
- name: "[update apt cache]"
  become: yes
  apt:
    update_cache: yes
    cache_valid_time: 3600
  when: "ansible_distribution == 'Debian' and (pkg_mgr is defined and (pkg_mgr == 'auto' or pkg_mgr == 'apt'))"
  ignore_errors: false

- name: "starting dotfile adapter execution"
  include_role:
    name: "makkus.dotfiles"
  vars:
    dotfile_folders: "{{ freckles_profile_folders }}"
    pkg_mgr: "{{ freckles_user_vars.pkg_mgr | default(omit) }}"
    unstow: "{{ freckles_user_vars.unstow | default(omit) }}"
    no_stow: "{{ freckles_user_vars.no_stow | default(omit) }}"
    no_package_install: "{{ freckles_user_vars.no_package_install | default(omit) }}"
    no_folder_install: "{{ freckles_user_vars.no_folder_install | default(omit) }}"
